using System.Diagnostics;
using System;

namespace GesFer.ConsoleApp.Services;

/// <summary>
/// Servicio para gestionar contenedores Docker
/// </summary>
public class DockerService
{
    private readonly string _apiPath;

    public DockerService()
    {
        _apiPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "..", "..", "..", "..", "Api");
    }

    /// <summary>
    /// Verifica si Docker está corriendo
    /// </summary>
    public async Task<bool> IsDockerRunningAsync()
    {
        try
        {
            var processInfo = new ProcessStartInfo
            {
                FileName = "docker",
                Arguments = "info",
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = Process.Start(processInfo);
            if (process == null)
            {
                return false;
            }

            await process.WaitForExitAsync();
            return process.ExitCode == 0;
        }
        catch
        {
            return false;
        }
    }

    /// <summary>
    /// Elimina contenedores Docker existentes
    /// </summary>
    public async Task<bool> RemoveContainersAsync()
    {
        Console.WriteLine("Limpiando contenedores existentes...");

        try
        {
            var processInfo = new ProcessStartInfo
            {
                FileName = "docker-compose",
                Arguments = "down -v",
                WorkingDirectory = _apiPath,
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = Process.Start(processInfo);
            if (process == null)
            {
                Console.WriteLine("    ERROR: No se pudo iniciar docker-compose");
                return false;
            }

            await process.WaitForExitAsync();

            if (process.ExitCode == 0)
            {
                Console.WriteLine("    ✓ Contenedores eliminados");
                return true;
            }
            else
            {
                Console.WriteLine("    ⚠ No se pudieron detener contenedores (puede que no existan)");
                return true; // No es un error crítico si no hay contenedores
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"    ERROR: {ex.Message}");
            return false;
        }
    }

    /// <summary>
    /// Crea contenedores Docker
    /// </summary>
    public async Task<bool> CreateContainersAsync()
    {
        Console.WriteLine("Creando contenedores Docker...");

        try
        {
            var processInfo = new ProcessStartInfo
            {
                FileName = "docker-compose",
                Arguments = "up -d",
                WorkingDirectory = _apiPath,
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = Process.Start(processInfo);
            if (process == null)
            {
                Console.WriteLine("    ERROR: No se pudo iniciar docker-compose");
                return false;
            }

            await process.WaitForExitAsync();

            if (process.ExitCode == 0)
            {
                Console.WriteLine("    ✓ Contenedores creados");
                return true;
            }
            else
            {
                Console.WriteLine("    ERROR: No se pudieron crear los contenedores");
                return false;
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"    ERROR: {ex.Message}");
            return false;
        }
    }

    /// <summary>
    /// Espera a que MySQL esté listo
    /// </summary>
    public async Task<bool> WaitForMySqlReadyAsync(int maxAttempts = 30, int delaySeconds = 2)
    {
        Console.WriteLine("Esperando a que MySQL esté listo...");

        for (int attempt = 1; attempt <= maxAttempts; attempt++)
        {
            try
            {
                var processInfo = new ProcessStartInfo
                {
                    FileName = "docker",
                    Arguments = "exec gesfer_api_db mysqladmin ping -h localhost -u root -prootpassword",
                    RedirectStandardOutput = true,
                    RedirectStandardError = true,
                    UseShellExecute = false,
                    CreateNoWindow = true
                };

                using var process = Process.Start(processInfo);
                if (process != null)
                {
                    await process.WaitForExitAsync();
                    if (process.ExitCode == 0)
                    {
                        Console.WriteLine("    ✓ MySQL está listo");
                        // Esperar un poco más para asegurar que MySQL esté completamente listo
                        await Task.Delay(TimeSpan.FromSeconds(5));
                        return true;
                    }
                }
            }
            catch
            {
                // Continuar intentando
            }

            if (attempt < maxAttempts)
            {
                Console.WriteLine($"    Intento {attempt}/{maxAttempts}...");
                await Task.Delay(TimeSpan.FromSeconds(delaySeconds));
            }
        }

        Console.WriteLine($"    ERROR: MySQL no está listo después de {maxAttempts} intentos");
        return false;
    }
}
using System;

namespace GesFer.ConsoleApp.Services;

/// <summary>
/// Servicio para mostrar y gestionar el menú interactivo
/// </summary>
public class MenuService
{
    private readonly DockerService _dockerService;
    private readonly MigrationService _migrationService;
    private readonly SeedService _seedService;

    public MenuService(
        DockerService dockerService,
        MigrationService migrationService,
        SeedService seedService)
    {
        _dockerService = dockerService;
        _migrationService = migrationService;
        _seedService = seedService;
    }

    /// <summary>
    /// Muestra el menú principal
    /// </summary>
    public void ShowMenu()
    {
        Console.Clear();
        Console.WriteLine("========================================");
        Console.WriteLine("        GesFer - Consola de Gestión");
        Console.WriteLine("========================================");
        Console.WriteLine();
        Console.WriteLine("Seleccione una opción:");
        Console.WriteLine();
        Console.WriteLine("  1. Inicialización completa");
        Console.WriteLine("  2. Gestionar contenedores Docker");
        Console.WriteLine("  3. Aplicar migraciones de BD");
        Console.WriteLine("  4. Ejecutar seeds de datos");
        Console.WriteLine("  5. Salir");
        Console.WriteLine();
        Console.Write("Opción: ");
    }

    /// <summary>
    /// Ejecuta la opción seleccionada
    /// </summary>
    public async Task<bool> ExecuteOptionAsync(int option)
    {
        try
        {
            switch (option)
            {
                case 1:
                    return await ExecuteFullInitializationAsync();
                case 2:
                    return await ExecuteDockerMenuAsync();
                case 3:
                    return await ExecuteMigrationsMenuAsync();
                case 4:
                    return await ExecuteSeedsMenuAsync();
                case 5:
                    return false; // Salir
                default:
                    Console.WriteLine("Opción no válida. Presione cualquier tecla para continuar...");
                    Console.ReadKey();
                    return true;
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error: {ex.Message}");
            Console.WriteLine("Presione cualquier tecla para continuar...");
            Console.ReadKey();
            return true;
        }
    }

    /// <summary>
    /// Ejecuta la inicialización completa
    /// </summary>
    private async Task<bool> ExecuteFullInitializationAsync()
    {
        Console.Clear();
        Console.WriteLine("========================================");
        Console.WriteLine("   Inicialización Completa GesFer");
        Console.WriteLine("========================================");
        Console.WriteLine();

        // 1. Verificar Docker
        Console.WriteLine("[1/8] Verificando Docker...");
        if (!await _dockerService.IsDockerRunningAsync())
        {
            Console.WriteLine("ERROR: Docker no está corriendo. Por favor, inicia Docker Desktop.");
            Console.WriteLine("Presione cualquier tecla para continuar...");
            Console.ReadKey();
            return true;
        }
        Console.WriteLine("    ✓ Docker está corriendo");
        Console.WriteLine();

        // 2. Eliminar contenedores
        Console.WriteLine("[2/8] Limpiando contenedores existentes...");
        await _dockerService.RemoveContainersAsync();
        Console.WriteLine();

        // 3. Crear contenedores
        Console.WriteLine("[3/8] Creando contenedores Docker...");
        if (!await _dockerService.CreateContainersAsync())
        {
            Console.WriteLine("ERROR: No se pudieron crear los contenedores");
            Console.WriteLine("Presione cualquier tecla para continuar...");
            Console.ReadKey();
            return true;
        }
        Console.WriteLine();

        // 4. Esperar MySQL
        Console.WriteLine("[4/8] Esperando a que MySQL esté listo...");
        if (!await _dockerService.WaitForMySqlReadyAsync())
        {
            Console.WriteLine("ERROR: MySQL no está listo");
            Console.WriteLine("Presione cualquier tecla para continuar...");
            Console.ReadKey();
            return true;
        }
        Console.WriteLine();

        // 5. Verificar/Instalar dotnet-ef
        Console.WriteLine("[5/8] Verificando herramienta dotnet-ef...");
        if (!await _migrationService.IsEfToolInstalledAsync())
        {
            if (!await _migrationService.InstallEfToolAsync())
            {
                Console.WriteLine("ERROR: No se pudo instalar dotnet-ef");
                Console.WriteLine("Presione cualquier tecla para continuar...");
                Console.ReadKey();
                return true;
            }
        }
        else
        {
            Console.WriteLine("    ✓ Herramienta dotnet-ef encontrada");
        }
        Console.WriteLine();

        // 6. Crear migraciones si no existen
        Console.WriteLine("[6/8] Verificando migraciones...");
        await _migrationService.CreateInitialMigrationIfNeededAsync();
        Console.WriteLine();

        // 7. Aplicar migraciones
        Console.WriteLine("[7/8] Aplicando migraciones a la base de datos...");
        if (!await _migrationService.ApplyMigrationsAsync())
        {
            Console.WriteLine("ERROR: No se pudieron aplicar las migraciones");
            Console.WriteLine("Presione cualquier tecla para continuar...");
            Console.ReadKey();
            return true;
        }
        await _migrationService.VerifyTablesCreatedAsync();
        Console.WriteLine();

        // 8. Ejecutar seeds
        Console.WriteLine("[8/8] Insertando datos iniciales...");
        await _seedService.ExecuteAllSeedsAsync();
        Console.WriteLine();

        Console.WriteLine("========================================");
        Console.WriteLine("   Inicialización completada");
        Console.WriteLine("========================================");
        Console.WriteLine();
        Console.WriteLine("Datos iniciales insertados:");
        Console.WriteLine("  ✓ Datos maestros (idiomas, permisos, grupos)");
        Console.WriteLine("  ✓ Datos de muestra (empresa, usuarios, clientes, proveedores)");
        Console.WriteLine("  ✓ Datos de prueba (para tests de integración)");
        Console.WriteLine();
        Console.WriteLine("Credenciales de acceso:");
        Console.WriteLine("  Empresa: Empresa Demo");
        Console.WriteLine("  Usuario: admin");
        Console.WriteLine("  Contraseña: admin123");
        Console.WriteLine();
        Console.WriteLine("Servicios disponibles:");
        Console.WriteLine("  - MySQL: localhost:3306");
        Console.WriteLine("  - Memcached: localhost:11211");
        Console.WriteLine("  - Adminer: http://localhost:8080");
        Console.WriteLine();
        Console.WriteLine("Presione cualquier tecla para continuar...");
        Console.ReadKey();

        return true;
    }

    /// <summary>
    /// Muestra el menú de Docker
    /// </summary>
    private async Task<bool> ExecuteDockerMenuAsync()
    {
        Console.Clear();
        Console.WriteLine("========================================");
        Console.WriteLine("   Gestión de Contenedores Docker");
        Console.WriteLine("========================================");
        Console.WriteLine();
        Console.WriteLine("  1. Eliminar contenedores");
        Console.WriteLine("  2. Crear contenedores");
        Console.WriteLine("  3. Eliminar y crear (reiniciar)");
        Console.WriteLine("  4. Volver al menú principal");
        Console.WriteLine();
        Console.Write("Opción: ");

        if (int.TryParse(Console.ReadLine(), out int option))
        {
            switch (option)
            {
                case 1:
                    await _dockerService.RemoveContainersAsync();
                    break;
                case 2:
                    await _dockerService.CreateContainersAsync();
                    break;
                case 3:
                    await _dockerService.RemoveContainersAsync();
                    await _dockerService.CreateContainersAsync();
                    break;
            }
        }

        Console.WriteLine();
        Console.WriteLine("Presione cualquier tecla para continuar...");
        Console.ReadKey();
        return true;
    }

    /// <summary>
    /// Muestra el menú de migraciones
    /// </summary>
    private async Task<bool> ExecuteMigrationsMenuAsync()
    {
        Console.Clear();
        Console.WriteLine("========================================");
        Console.WriteLine("   Gestión de Migraciones");
        Console.WriteLine("========================================");
        Console.WriteLine();
        Console.WriteLine("  1. Crear migración inicial (si no existe)");
        Console.WriteLine("  2. Aplicar migraciones");
        Console.WriteLine("  3. Crear y aplicar migraciones");
        Console.WriteLine("  4. Volver al menú principal");
        Console.WriteLine();
        Console.Write("Opción: ");

        if (int.TryParse(Console.ReadLine(), out int option))
        {
            switch (option)
            {
                case 1:
                    await _migrationService.CreateInitialMigrationIfNeededAsync();
                    break;
                case 2:
                    await _migrationService.ApplyMigrationsAsync();
                    break;
                case 3:
                    await _migrationService.CreateInitialMigrationIfNeededAsync();
                    await _migrationService.ApplyMigrationsAsync();
                    break;
            }
        }

        Console.WriteLine();
        Console.WriteLine("Presione cualquier tecla para continuar...");
        Console.ReadKey();
        return true;
    }

    /// <summary>
    /// Muestra el menú de seeds
    /// </summary>
    private async Task<bool> ExecuteSeedsMenuAsync()
    {
        Console.Clear();
        Console.WriteLine("========================================");
        Console.WriteLine("   Ejecución de Seeds");
        Console.WriteLine("========================================");
        Console.WriteLine();
        Console.WriteLine("  1. Ejecutar datos maestros");
        Console.WriteLine("  2. Ejecutar datos de muestra");
        Console.WriteLine("  3. Ejecutar datos de prueba");
        Console.WriteLine("  4. Ejecutar todos los seeds");
        Console.WriteLine("  5. Volver al menú principal");
        Console.WriteLine();
        Console.Write("Opción: ");

        if (int.TryParse(Console.ReadLine(), out int option))
        {
            switch (option)
            {
                case 1:
                    await _seedService.ExecuteMasterDataAsync();
                    break;
                case 2:
                    await _seedService.ExecuteSampleDataAsync();
                    break;
                case 3:
                    await _seedService.ExecuteTestDataAsync();
                    break;
                case 4:
                    await _seedService.ExecuteAllSeedsAsync();
                    break;
            }
        }

        Console.WriteLine();
        Console.WriteLine("Presione cualquier tecla para continuar...");
        Console.ReadKey();
        return true;
    }
}
using System;

namespace GesFer.ConsoleApp.Services;

/// <summary>
/// Servicio para gestionar migraciones de Entity Framework
/// </summary>
public class MigrationService
{
    private readonly string _connectionString;

    public MigrationService()
    {
        _connectionString = "Server=localhost;Port=3306;Database=ScrapDb;User=scrapuser;Password=scrappassword;CharSet=utf8mb4;AllowUserVariables=True;AllowLoadLocalInfile=True;";
    }

    /// <summary>
    /// Verifica si existe la herramienta dotnet-ef
    /// </summary>
    public async Task<bool> IsEfToolInstalledAsync()
    {
        try
        {
            var processInfo = new System.Diagnostics.ProcessStartInfo
            {
                FileName = "dotnet",
                Arguments = "ef --version",
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = System.Diagnostics.Process.Start(processInfo);
            if (process == null)
            {
                return false;
            }

            await process.WaitForExitAsync();
            return process.ExitCode == 0;
        }
        catch
        {
            return false;
        }
    }

    /// <summary>
    /// Instala la herramienta dotnet-ef si no está instalada
    /// </summary>
    public async Task<bool> InstallEfToolAsync()
    {
        Console.WriteLine("    Instalando herramienta dotnet-ef...");

        try
        {
            // Intentar instalar con versión específica
            var processInfo = new System.Diagnostics.ProcessStartInfo
            {
                FileName = "dotnet",
                Arguments = "tool install --global dotnet-ef --version 8.0.0",
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = System.Diagnostics.Process.Start(processInfo);
            if (process != null)
            {
                await process.WaitForExitAsync();
            if (process.ExitCode == 0)
            {
                Console.WriteLine("    ✓ Herramienta dotnet-ef instalada correctamente");
                return true;
            }
        }

        // Si falla, intentar sin versión específica
        Console.WriteLine("    ⚠ Falló instalación con versión específica. Intentando sin versión...");
        processInfo.Arguments = "tool install --global dotnet-ef";
        using var process2 = System.Diagnostics.Process.Start(processInfo);
        if (process2 != null)
        {
            await process2.WaitForExitAsync();
            if (process2.ExitCode == 0)
            {
                Console.WriteLine("    ✓ Herramienta dotnet-ef instalada correctamente");
                return true;
            }
        }

        Console.WriteLine("    ERROR: No se pudo instalar la herramienta dotnet-ef");
        return false;
    }
    catch (Exception ex)
    {
        Console.WriteLine($"    ERROR: {ex.Message}");
        return false;
    }
    }

    /// <summary>
    /// Crea la migración inicial si no existe
    /// </summary>
    public async Task<bool> CreateInitialMigrationIfNeededAsync()
    {
        var apiPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "..", "..", "..", "..", "Api", "src", "Api");
        var infrastructurePath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "..", "..", "..", "..", "Api", "src", "Infrastructure");
        var migrationsPath = Path.Combine(infrastructurePath, "Migrations");

        // Verificar si existen migraciones
        if (Directory.Exists(migrationsPath))
        {
            var migrationFiles = Directory.GetFiles(migrationsPath, "*.cs");
            if (migrationFiles.Length > 0)
            {
                Console.WriteLine("    ✓ Migraciones existentes encontradas");
                return true;
            }
        }

        Console.WriteLine("    No se encontraron migraciones. Creando migración inicial...");

        try
        {
            var processInfo = new System.Diagnostics.ProcessStartInfo
            {
                FileName = "dotnet",
                Arguments = $"ef migrations add InitialCreate --project \"{Path.Combine(infrastructurePath, "GesFer.Infrastructure.csproj")}\" --startup-project \"{Path.Combine(apiPath, "GesFer.Api.csproj")}\"",
                WorkingDirectory = apiPath,
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = System.Diagnostics.Process.Start(processInfo);
            if (process == null)
            {
                Console.WriteLine("    ERROR: No se pudo iniciar dotnet ef");
                return false;
            }

            await process.WaitForExitAsync();

            if (process.ExitCode == 0)
            {
                Console.WriteLine("    ✓ Migración inicial creada");
                return true;
            }
            else
            {
                Console.WriteLine("    ERROR: No se pudieron crear las migraciones");
                return false;
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"    ERROR: {ex.Message}");
            return false;
        }
    }

    /// <summary>
    /// Aplica las migraciones a la base de datos
    /// </summary>
    public async Task<bool> ApplyMigrationsAsync()
    {
        Console.WriteLine("    Aplicando migraciones a la base de datos...");

        var apiPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "..", "..", "..", "..", "Api", "src", "Api");
        var infrastructurePath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "..", "..", "..", "..", "Api", "src", "Infrastructure");

        try
        {
            var processInfo = new System.Diagnostics.ProcessStartInfo
            {
                FileName = "dotnet",
                Arguments = $"ef database update --project \"{Path.Combine(infrastructurePath, "GesFer.Infrastructure.csproj")}\" --startup-project \"{Path.Combine(apiPath, "GesFer.Api.csproj")}\"",
                WorkingDirectory = apiPath,
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = System.Diagnostics.Process.Start(processInfo);
            if (process == null)
            {
                Console.WriteLine("    ERROR: No se pudo iniciar dotnet ef");
                return false;
            }

            await process.WaitForExitAsync();

            if (process.ExitCode == 0)
            {
                Console.WriteLine("    ✓ Migraciones aplicadas correctamente");
                return true;
            }
            else
            {
                Console.WriteLine("    ERROR: No se pudieron aplicar las migraciones");
                return false;
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"    ERROR: {ex.Message}");
            return false;
        }
    }

    /// <summary>
    /// Verifica que las tablas se hayan creado correctamente usando docker exec
    /// </summary>
    public async Task<bool> VerifyTablesCreatedAsync()
    {
        try
        {
            var processInfo = new System.Diagnostics.ProcessStartInfo
            {
                FileName = "docker",
                Arguments = "exec gesfer_api_db mysql -u scrapuser -pscrappassword ScrapDb -e \"SELECT COUNT(*) as total FROM information_schema.tables WHERE table_schema = 'ScrapDb';\" --skip-column-names",
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = System.Diagnostics.Process.Start(processInfo);
            if (process != null)
            {
                await process.WaitForExitAsync();
                if (process.ExitCode == 0)
                {
                    var output = await process.StandardOutput.ReadToEndAsync();
                    if (int.TryParse(output.Trim(), out int tableCount) && tableCount > 0)
                    {
                        Console.WriteLine($"    ✓ Tablas creadas correctamente (Total: {tableCount})");
                        return true;
                    }
                }
            }

            Console.WriteLine("    ⚠ No se pudo verificar las tablas, pero las migraciones se aplicaron");
            return true; // No es crítico
        }
        catch (Exception ex)
        {
            Console.WriteLine($"    ⚠ No se pudo verificar las tablas, pero las migraciones se aplicaron: {ex.Message}");
            return true; // No es crítico
        }
    }
}
using System.Diagnostics;
using System;

namespace GesFer.ConsoleApp.Services;

/// <summary>
/// Servicio para ejecutar scripts SQL de seed
/// </summary>
public class SeedService
{
    private readonly string _rootPath;

    public SeedService()
    {
        _rootPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "..", "..", "..", "..");
    }

    /// <summary>
    /// Ejecuta un script SQL en el contenedor MySQL
    /// </summary>
    private async Task<bool> ExecuteSqlScriptAsync(string scriptPath, string scriptName)
    {
        if (!File.Exists(scriptPath))
        {
            Console.WriteLine($"    ⚠ No se encontró el archivo {scriptName}");
            Console.WriteLine($"       Buscado en: {scriptPath}");
            return false;
        }

        Console.WriteLine($"    Ejecutando {scriptName}...");

        try
        {
            // Leer el contenido del script
            var scriptContent = await File.ReadAllTextAsync(scriptPath);

            var processInfo = new ProcessStartInfo
            {
                FileName = "docker",
                Arguments = "exec -i gesfer_api_db mysql -u scrapuser -pscrappassword ScrapDb",
                RedirectStandardInput = true,
                RedirectStandardOutput = true,
                RedirectStandardError = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            using var process = Process.Start(processInfo);
            if (process == null)
            {
                Console.WriteLine($"    ERROR: No se pudo iniciar docker para ejecutar {scriptName}");
                return false;
            }

            // Escribir el script en la entrada estándar
            await process.StandardInput.WriteAsync(scriptContent);
            process.StandardInput.Close();

            await process.WaitForExitAsync();

            if (process.ExitCode == 0)
            {
                Console.WriteLine($"    ✓ {scriptName} ejecutado correctamente");
                return true;
            }
            else
            {
                var error = await process.StandardError.ReadToEndAsync();
                Console.WriteLine($"    ⚠ Error al ejecutar {scriptName} (puede que algunos datos ya existan)");
                return true; // No es crítico si algunos datos ya existen
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"    ⚠ Error al ejecutar {scriptName} (puede que algunos datos ya existan): {ex.Message}");
            return true; // No es crítico
        }
    }

    /// <summary>
    /// Ejecuta el script de datos maestros
    /// </summary>
    public async Task<bool> ExecuteMasterDataAsync()
    {
        Console.WriteLine("Insertando datos maestros...");
        var scriptPath = Path.Combine(_rootPath, "Api", "scripts", "master-data.sql");
        return await ExecuteSqlScriptAsync(scriptPath, "master-data.sql");
    }

    /// <summary>
    /// Ejecuta el script de datos de muestra
    /// </summary>
    public async Task<bool> ExecuteSampleDataAsync()
    {
        Console.WriteLine("Insertando datos de muestra...");
        var scriptPath = Path.Combine(_rootPath, "Api", "scripts", "sample-data.sql");
        return await ExecuteSqlScriptAsync(scriptPath, "sample-data.sql");
    }

    /// <summary>
    /// Ejecuta el script de datos de prueba
    /// </summary>
    public async Task<bool> ExecuteTestDataAsync()
    {
        Console.WriteLine("Insertando datos de prueba...");
        var scriptPath = Path.Combine(_rootPath, "Api", "scripts", "test-data.sql");
        return await ExecuteSqlScriptAsync(scriptPath, "test-data.sql");
    }

    /// <summary>
    /// Ejecuta todos los scripts de seed en orden
    /// </summary>
    public async Task<bool> ExecuteAllSeedsAsync()
    {
        var masterResult = await ExecuteMasterDataAsync();
        await Task.Delay(500); // Pequeña pausa entre scripts

        var sampleResult = await ExecuteSampleDataAsync();
        await Task.Delay(500);

        var testResult = await ExecuteTestDataAsync();

        return masterResult && sampleResult && testResult;
    }
}
using GesFer.ConsoleApp.Services;
using System;

namespace GesFer.ConsoleApp;

class Program
{
    static async Task Main(string[] args)
    {
        // Configurar codificación UTF-8 para la consola
        Console.OutputEncoding = System.Text.Encoding.UTF8;

        // Crear instancias de los servicios
        var dockerService = new DockerService();
        var migrationService = new MigrationService();
        var seedService = new SeedService();
        var menuService = new MenuService(dockerService, migrationService, seedService);

        bool continueRunning = true;

        while (continueRunning)
        {
            try
            {
                menuService.ShowMenu();

                var input = Console.ReadLine();
                if (int.TryParse(input, out int option))
                {
                    continueRunning = await menuService.ExecuteOptionAsync(option);
                }
                else
                {
                    Console.WriteLine("Opción no válida. Presione cualquier tecla para continuar...");
                    Console.ReadKey();
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error inesperado: {ex.Message}");
                Console.WriteLine("Presione cualquier tecla para continuar...");
                Console.ReadKey();
            }
        }

        Console.WriteLine();
        Console.WriteLine("¡Hasta luego!");
    }
}
